<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>High Correlation Filter — step_corr • recipes</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">recipes</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/1_Simple_Example.html">Simple Example</a>
</li>
<li>
  <a href="../articles/2_Selecting_Variables.html">Selecting Variables</a>
</li>
<li>
  <a href="../articles/3_Custom_Steps.html">Custom Steps</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/topepo/recipes">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>High Correlation Filter</h1>
    </div>

    
    <p><code>step_corr</code> creates a <em>specification</em> of a recipe step that will potentially remove variables that have large absolute correlations with other variables.</p>
    

    <pre><span class='fu'>step_corr</span>(<span class='no'>recipe</span>, <span class='no'>terms</span>, <span class='kw'>role</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>trained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.9</span>,
  <span class='kw'>use</span> <span class='kw'>=</span> <span class='st'>"pairwise.complete.obs"</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"pearson"</span>, <span class='kw'>removals</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>recipe</dt>
      <dd>A recipe object. The step will be added to the sequence of operations for this recipe.</dd>
      <dt>terms</dt>
      <dd>A representation of the variables or terms that will evaluated by the filtering process.</dd>
      <dt>role</dt>
      <dd>Not used by this step since no new variables are created.</dd>
      <dt>trained</dt>
      <dd>A logical to indicate if the quantities for preprocessing have been estimated.</dd>
      <dt>threshold</dt>
      <dd>A value for the threshold of absolute correlation values. The step will try to remove the minimum number of columns so that all the resulting absolute correlations are less than this value.</dd>
      <dt>use</dt>
      <dd>A character string for the <code>use</code> argument to the <code><a href='http://www.rdocumentation.org/packages/stats/topics/cor'>cor</a></code> function.</dd>
      <dt>method</dt>
      <dd>A character string for the <code>method</code> argument to the <code><a href='http://www.rdocumentation.org/packages/stats/topics/cor'>cor</a></code> function.</dd>
      <dt>removals</dt>
      <dd>A character string that contains the names of columns that should be removed. These values are not determined until <code><a href='learn.html'>learn.recipe</a></code> is called.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>step_corr</code>  returns an object of class <code>step_corr</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This step attempts to remove variables to keep the largest absolute correlation between the variables less than <code>threshold</code>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='step_nzv.html'>step_nzv</a></code>    <code><a href='recipe.html'>recipe</a></code> <code><a href='learn.html'>learn.recipe</a></code> <code><a href='process.html'>process.recipe</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>biomass</span>)

<span class='fu'>set.seed</span>(<span class='fl'>3535</span>)
<span class='no'>biomass</span>$<span class='no'>duplicate</span> <span class='kw'>&lt;-</span> <span class='no'>biomass</span>$<span class='no'>carbon</span> + <span class='fu'>rnorm</span>(<span class='fu'>nrow</span>(<span class='no'>biomass</span>))

<span class='no'>biomass_tr</span> <span class='kw'>&lt;-</span> <span class='no'>biomass</span>[<span class='no'>biomass</span>$<span class='no'>dataset</span> <span class='kw'>==</span> <span class='st'>"Training"</span>,]
<span class='no'>biomass_te</span> <span class='kw'>&lt;-</span> <span class='no'>biomass</span>[<span class='no'>biomass</span>$<span class='no'>dataset</span> <span class='kw'>==</span> <span class='st'>"Testing"</span>,]

<span class='no'>rec</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='recipe.html'>recipe</a></span>(<span class='no'>HHV</span> ~ <span class='no'>carbon</span> + <span class='no'>hydrogen</span> + <span class='no'>oxygen</span> + <span class='no'>nitrogen</span> + <span class='no'>sulfur</span> + <span class='no'>duplicate</span>,
              <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>biomass_tr</span>)

<span class='fu'>library</span>(<span class='no'>magrittr</span>)
<span class='no'>corr_filter</span> <span class='kw'>&lt;-</span> <span class='no'>rec</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>step_corr</span>(<span class='kw'>terms</span> <span class='kw'>=</span> ~ <span class='fu'><a href='role_is.html'>is_predictor</a></span>(), <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>.5</span>)

<span class='no'>filter_obj</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='learn.html'>learn</a></span>(<span class='no'>corr_filter</span>, <span class='kw'>training</span> <span class='kw'>=</span> <span class='no'>biomass_tr</span>)</div><div class='output co'>#&gt; step 1 corr training </div><div class='input'>
<span class='no'>filtered_te</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='process.html'>process</a></span>(<span class='no'>filter_obj</span>, <span class='no'>biomass_te</span>, <span class='kw'>role</span> <span class='kw'>=</span> <span class='st'>"predictor"</span>)
<span class='fu'>round</span>(<span class='fu'>abs</span>(<span class='fu'>cor</span>(<span class='no'>biomass_tr</span>[, <span class='fu'>c</span>(<span class='fl'>3</span>:<span class='fl'>7</span>, <span class='fl'>9</span>)])), <span class='fl'>2</span>)</div><div class='output co'>#&gt;           carbon hydrogen oxygen nitrogen sulfur duplicate
#&gt; carbon      1.00     0.32   0.63     0.15   0.09      1.00
#&gt; hydrogen    0.32     1.00   0.54     0.07   0.19      0.31
#&gt; oxygen      0.63     0.54   1.00     0.18   0.31      0.63
#&gt; nitrogen    0.15     0.07   0.18     1.00   0.27      0.15
#&gt; sulfur      0.09     0.19   0.31     0.27   1.00      0.10
#&gt; duplicate   1.00     0.31   0.63     0.15   0.10      1.00</div><div class='input'><span class='fu'>round</span>(<span class='fu'>abs</span>(<span class='fu'>cor</span>(<span class='no'>filtered_te</span>)), <span class='fl'>2</span>)</div><div class='output co'>#&gt;           hydrogen nitrogen sulfur duplicate
#&gt; hydrogen      1.00     0.11   0.26      0.20
#&gt; nitrogen      0.11     1.00   0.16      0.13
#&gt; sulfur        0.26     0.16   1.00      0.13
#&gt; duplicate     0.20     0.13   0.13      1.00</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Original R code for filtering algorithm by Dong Li, modified by Max Kuhn. Contributions by Reynald Lescarbeau (for original in <code>caret</code> package). Max Kuhn for the <code>step</code> function.

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Max Kuhn, <a href='http://hadley.nz'>Hadley Wickham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
